profile: https://openspec.dev/profiles/@software
kind: software
meta:
  id: BUG-432
  title: Reset Password flow is reliable and secure
  owner: app-auth
  priority: P0
  labels: [bug, auth, reset-password]

requirements:
  - id: BUG-432.1
    statement: Password reset requests succeed for valid users and enforce safety controls
    criteria:
      - id: BUG-432.1.1
        type: functional
        text: Requesting a reset for a registered email responds 200 and sends a reset email
        bdd_ref:
          source: https://openspec.dev/profiles/bdd/cucumber
          path: https://example.org/bdd/cucumber/BUG-RESET-PASSWORD.feature
          scenario: Sends reset email for registered address
      - id: BUG-432.1.2
        type: security
        text: Reset token expires after 30 minutes and becomes invalid after first use
        bdd_ref:
          source: https://openspec.dev/profiles/bdd/cucumber
          path: https://example.org/bdd/cucumber/BUG-RESET-PASSWORD.feature
          scenario: Token expiry and single use are enforced
      - id: BUG-432.1.3
        type: security
        text: Requests are rate limited to 5 per 15 minutes per user and per IP
      - id: BUG-432.1.4
        type: accessibility
        text: Reset page and email content meet WCAG 2.1 AA form and link requirements
