profile: https://mindscript.dev/profiles/@software
kind: software
meta:
  id: AUTH-101
  title: User can log in with email and password
  owner: app-auth
  priority: P0
  labels: [auth, behat, php]

requirements:
  - id: AUTH-101.1
    statement: Users can authenticate with valid credentials
    criteria:
      - id: AUTH-101.1.1
        type: functional
        text: Valid credentials produce a successful session
        bdd_ref:
          source: https://mindscript.dev/profiles/bdd/behat
          path: https://example.org/bdd/behat/AUTH-101.feature
          scenario: Valid credentials produce a successful session

      - id: AUTH-101.1.2
        type: security
        text: Invalid credentials are rejected with a generic error that does not reveal whether the email exists
        bdd_ref:
          source: https://mindscript.dev/profiles/bdd/behat
          path: https://example.org/bdd/behat/AUTH-101.feature
          scenario: Invalid credentials are rejected

      - id: AUTH-101.1.3
        type: security
        text: Passwords must be at least 12 characters and include at least one uppercase letter, one lowercase letter, and one digit
        bdd_ref:
          source: https://mindscript.dev/profiles/bdd/behat
          path: https://example.org/bdd/behat/AUTH-101.feature
          scenario: Password policy is enforced

      - id: AUTH-101.1.4
        type: security
        text: After 5 failed attempts within 15 minutes the account is locked for 15 minutes or until a successful password reset
        bdd_ref:
          source: https://mindscript.dev/profiles/bdd/behat
          path: https://example.org/bdd/behat/AUTH-101.feature
          scenario: Account lockout after repeated failures

      - id: AUTH-101.1.5
        type: security
        text: If the user has MFA enabled, a second factor challenge is required after password verification before the session is created
        bdd_ref:
          source: https://mindscript.dev/profiles/bdd/behat
          path: https://example.org/bdd/behat/AUTH-101.feature
          scenario: MFA challenge shown for enrolled users
