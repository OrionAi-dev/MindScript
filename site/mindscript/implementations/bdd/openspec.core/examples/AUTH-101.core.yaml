profile: https://openspec.dev/profiles/bdd/openspec.core
kind: bdd-core
meta:
  id: AUTH-101.core
  title: AUTH-101 login scenarios
  tags: [auth]

background:
  steps:
    - { keyword: Given, text: "a registered user with a verified email" }

scenarios:
  - id: auth-login-success
    name: Valid credentials produce a successful session
    tags: [happy-path]
    steps:
      - { keyword: When, text: "the user submits valid credentials" }
      - { keyword: Then, text: "the app creates a session and redirects to the dashboard" }

  - id: auth-login-invalid
    name: Invalid credentials are rejected with a generic error
    steps:
      - { keyword: When, text: "the user submits an invalid password" }
      - { keyword: Then, text: "the user sees a generic error message" }

  - id: lockout-after-failures
    name: Account is locked after 5 failed attempts within 15 minutes
    steps:
      - { keyword: Given, text: "the user has failed to log in 5 times within 15 minutes" }
      - { keyword: When, text: "the user attempts to log in again" }
      - { keyword: Then, text: "the account is temporarily locked" }

  - id: mfa-challenge
    name: MFA challenge is required for enrolled users
    outline: true
    examples:
      - { factor: "totp" }
      - { factor: "sms" }
    steps:
      - { keyword: Given, text: "the user is enrolled in {factor} MFA" }
      - { keyword: When, text: "the user submits valid credentials" }
      - { keyword: Then, text: "the user is prompted for {factor} and session is created after success" }
